{%extends 'layout.htm'%}
{%block main%}
  <!--Main layout-->
  <main class="mt-5 pt-5">
      <div class="container text-center col-8">
  
        <!--Section: Jumbotron-->
        <section class="card wow fadeIn" style="background-image: url(https://mdbootstrap.com/img/Photos/Others/gradient1.jpg);">
          <!-- Content -->
          <div class="card-body text-white text-center py-5 px-5 my-5">
  
            <h1 class="mb-4">
              <strong>Not sure about your words? <br> 
                Check out at MyCorpus !</strong>
            </h1>
            <p>
              <strong>Real-World English from TED.com</strong>
            </p>
  
          </div>
          <!-- Content -->
        </section>
  
        <!--Section: Jumbotron-->
  
        <hr class="my-5">
        <!-- 한/영 영/한-->
  
        <ul class="nav nav-pills mb-3" id="pills-koreng-tab" role="tablist">
          <li class="nav-item">
            <a class="nav-link active" id="pills-koreng-tab" data-toggle="pill" href="#pills-home" role="tab"
              aria-controls="pills-home" aria-selected="true">한/영</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="pills-engkor-tab" data-toggle="pill" href="#pills-profile" role="tab"
              aria-controls="pills-profile" aria-selected="false">영/한</a>
          </li>
        </ul>
        <div class="tab-content" id="pills-tabContent">
          <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
            <div class="md-form form-inline">
            <!-- <form class="form-inline mb-4"> -->
              <input id="ksearchwords" name="ksearchwords" type="text" class="w-75" placeholder='입력하세요.' aria-describedby="MaterialButton-addon2">
              <button id = "korsearch" class="btn btn-md btn-secondary ml-4 m-0 px-3" type="button" >Search</button>
            <!-- </form> -->
            </div>
            
          </div>
  
          <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
            <div class="md-form form-inline">
              <input type="text" class="w-75" placeholder='Write words or phrases' aria-describedby="MaterialButton-addon2">
              <button class="btn btn-md btn-secondary ml-4 m-0 px-3 " type="button">Search</button>
            </div>
          </div>
        </div>
      </div>

      <!-- <section class="text-center"> -->
        <div class="container text-center col-8">
          <div class="row">
            <script id="entry-template" type="text/x-handlebars-template">
              <div id="result" class="col-8">
              {% raw %}
              {{#list data}}{{korsentences}} {{result}} {{/list}}
              {% endraw %}
              </div>
              </script>
              <ul id = "ulsearch" class="list-group list-group-flush">
                <li id = "searchwords" class="list-group-item text-left">검색어</li>
                <li id = "searchresult" class="list-group-item text-left">
                  <button type="button" class="btn btn-sm tn-outline-dark btn-rounded waves-effect">...</button> 
                    <br> 결과<br>
                  <button type="button" class="btn btn-sm tn-outline-dark btn-rounded waves-effect">...</button>
                </li>
              </ul>
            </div>

        <div class="col-4">
          <!-- Card -->
          <div class="card">

            <!-- Card image -->
            <!-- <img class="card-img-top" src="https://mdbootstrap.com/img/Photos/Others/images/43.jpg" alt="Card image cap"> -->
          
            <!-- Card content -->
            <div class="card-body">
        
              <!-- Title -->
              <div class="form-inline">
                <h4 class="card-title">Tags</h4>
                <!-- Button -->
                <a id="tags" class="btn btn-sm btn-default ml-5">
                  Click <i class="fas fa-magic ml-1"></i>
                </a>
                <!-- Text -->
                <p class="card-text"> </p>
              </div>
            </div>
            
          </div>
          <!-- Card -->
        </div>
          </div>
        </div>
      <!-- </section> -->

  
  
  
          <!--Pagination-->
          <nav class="d-flex justify-content-center wow fadeIn">
            <ul class="pagination pg-blue">
  
              <!--Arrow left-->
              <li class="page-item disabled">
                <a class="page-link" href="#" aria-label="Previous">
                  <span aria-hidden="true">&laquo;</span>
                  <span class="sr-only">Previous</span>
                </a>
              </li>
  
              <li class="page-item active">
                <a class="page-link" href="#">1
                  <span class="sr-only">(current)</span>
                </a>
              </li>
              <li class="page-item">
                <a class="page-link" href="#">2</a>
              </li>
              <li class="page-item">
                <a class="page-link" href="#">3</a>
              </li>
              <li class="page-item">
                <a class="page-link" href="#">4</a>
              </li>
              <li class="page-item">
                <a class="page-link" href="#">5</a>
              </li>
  
              <li class="page-item">
                <a class="page-link" href="#" aria-label="Next">
                  <span aria-hidden="true">&raquo;</span>
                  <span class="sr-only">Next</span>
                </a>
              </li>
            </ul>
          </nav>
          <!--Pagination-->
      </div>
  </main>
  <!--Main layout-->  
  <script>
    $('a#tags').click(function () {
      $('a#tags').hide()
      $.ajax({
        url:'/tags',
        type:'GET',
        error : function(res) {
          console.log("Error!!")
        }, 
        success: function(res) {
          console.log("got json");
          // var ts = JSON.parse(res);
          console.log("res>>>", res)
          var tags = res['tags']
          console.log(typeof(tags))
          var splittags = tags.split(',')
          console.log(typeof(splittags), splittags)
          for (var i = 0; i < splittags.length; i++){
            // 매번 선언
            var span;
            var span = $('<span>')
            span.attr("id", "tag" + (i+1))
            var tag = splittags[i] 
            span.addClass("badge").addClass("badge-pill").addClass("badge-default")
            span.text(tag).appendTo('p.card-text')
          }
        }
      });
    });

    function hbs(sourceId, data) {
        var source = document.getElementById(sourceId).innerHTML;
        var template = Handlebars.compile(source);
        var html = template(data);
        // document.getElementById(resultId).innerHTML = html;
    }

    Handlebars.registerHelper('list', function(items, options) {
      var out = "<ul>";
      for( var k=0; k < items.length; k++ ) {
        out = out + "<li>" + options.fn(items[i] + "</li>");
      }
      return out + "</ul>";
    });

    $('#korsearch').click( function() {
      $.ajax({
        url: '/search/' + $('#korsearch').val(),
        type: 'GET',
        error: function(res) {
          console.log("Error!!", res)
        },
        success: function(res) {
          var data = res
            hbs("entry-template", data)
      }
    })
    });
    function send_ajax(url, data, method, dataType, fn) {
      $.ajax({
        url : url,
        data : data, 
        type : method,
        dataType: dataType
      }).done(function (res) {
        console.log("res>>>", res)
        if (fn)
          fn(res)
      }).fail(function (xhr, status, errorThrown) {
        console.error("Error!", xhr, status, errorThrown)
      }).always(function (xhr, status) {
        console.log("request complete")
      });
    }
  
    
  
  
  </script>
{%endblock main%}